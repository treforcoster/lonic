import { __decorate, __metadata } from "tslib";
import { ServiceContainer } from '@roots/bud-framework/service';
import { bind } from '@roots/bud-support/decorators';
/**
 * Env service
 */
export default class Env extends ServiceContainer {
    /**
     * Bootstrap event callback
     */
    async bootstrap(bud) {
        this.setStore(bud.context.env);
    }
    /**
     * Get entries from .env which include `APP_PUBLIC` in their name
     *
     * @public
     * @decorator `@bind`
     */
    getPublicEnv() {
        return this.getEntries()
            .filter(this.filterPublicEnv)
            .map(this.transformPublicEnv)
            .reduce((a, [k, v]) => ({ ...a, [k]: v }), {});
    }
    /**
     * Transform public env
     */
    transformPublicEnv([rawKey, rawValue]) {
        return [rawKey.replace(`PUBLIC_`, ``), rawValue];
    }
    /**
     * Filter public env
     */
    filterPublicEnv([key]) {
        return key.startsWith(`PUBLIC_`);
    }
}
__decorate([
    bind,
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Function]),
    __metadata("design:returntype", Promise)
], Env.prototype, "bootstrap", null);
__decorate([
    bind,
    __metadata("design:type", Function),
    __metadata("design:paramtypes", []),
    __metadata("design:returntype", Object)
], Env.prototype, "getPublicEnv", null);
__decorate([
    bind,
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Array]),
    __metadata("design:returntype", Array)
], Env.prototype, "transformPublicEnv", null);
__decorate([
    bind,
    __metadata("design:type", Function),
    __metadata("design:paramtypes", [Array]),
    __metadata("design:returntype", Boolean)
], Env.prototype, "filterPublicEnv", null);
//# sourceMappingURL=env.js.map